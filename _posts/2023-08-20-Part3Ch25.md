---
title: "3.9 Public Key Infrastructure"
date: 2023-08-20 17:00:00 +500
categories: [Security+, Part III]
tags: []    # TAG names should always be lowercase
---


<style>
  p {
    text-align: justify;
  }
  </style>


# 3.9 Public Key Infrastructure

## Public Key Infrastructure (PKI)

### Key Management

Key management is the process of generating, storing, distributing, and maintaining cryptographic keys used in a PKI. Proper key management is essential to ensure the confidentiality, integrity, and availability of encrypted data and digital signatures. It involves practices such as key generation using strong algorithms, secure storage of private keys, and regular key rotation to mitigate the risk of key compromise.

### Certificate Authority (CA)
A Certificate Authority (CA) is a trusted entity responsible for issuing digital certificates. When a CA issues a certificate, it digitally signs it using its private key, creating a digital signature that can be used to verify the authenticity of the certificate. CAs play a critical role in establishing trust within a PKI by confirming the identity of certificate applicants and ensuring the integrity of issued certificates.

### Intermediate CA

An Intermediate CA is a CA that is subordinate to a root CA within a PKI hierarchy. This hierarchical structure enhances security by allowing organizations to delegate certificate issuance to intermediate CAs while keeping the root CA offline and secure. Intermediate CAs are often used to sign end-entity certificates, forming a certificate chain that establishes trust.

### Registration Authority (RA)

A Registration Authority (RA) serves as an identity verifier for certificate applicants. It performs identity checks, verifies documentation, and validates the accuracy of information before forwarding certificate requests to the CA for issuance. RAs play a crucial role in the verification process, ensuring that certificates are only issued to legitimate entities.

### Certificate Revocation List (CRL)

A Certificate Revocation List (CRL) is a periodically published list by a CA that contains information about certificates that have been revoked before their scheduled expiration. This list is made available to users and systems, allowing them to verify the revocation status of certificates. CRLs help prevent the use of compromised or unauthorized certificates.

### Certificate Attributes

Certificate attributes are pieces of information associated with a digital certificate that provide additional context and details about the certificate holder. Common attributes include the certificate holder's name, organization, email address, and expiration date. These attributes help users and systems make informed decisions about trusting the certificate.

### Online Certificate Status Protocol (OCSP)

OCSP is a protocol used to check the real-time revocation status of a digital certificate. Instead of relying solely on periodically published CRLs, OCSP enables clients to query the CA or an OCSP responder to quickly determine whether a certificate is still valid. This reduces the reliance on potentially outdated revocation information.

### Certificate Signing Request (CSR)

A Certificate Signing Request (CSR) is a message generated by the certificate applicant and submitted to a CA. The CSR includes the public key of the certificate applicant, along with identifying information such as the Common Name (CN) and Subject Alternative Name (SAN). The CA uses the CSR to create a digital certificate that matches the provided information.

### CN (Common Name)

The Common Name (CN) attribute is part of a digital certificate and typically represents the fully qualified domain name of the certificate holder. For SSL/TLS certificates, the CN field contains the domain name of the website, allowing clients to verify the certificate's association with the domain.

### Subject Alternative Name (SAN)

The Subject Alternative Name (SAN) extension is included in digital certificates to allow them to secure multiple domain names under a single certificate. This is particularly useful for SSL/TLS certificates used to secure websites with multiple subdomains.

### Expiration

The expiration date is a crucial attribute of a digital certificate. It indicates when the certificate will no longer be considered valid. Certificate expiration is important for security reasons, as outdated certificates can pose risks to the confidentiality and integrity of communications.

## Types of Certificates

### Wildcard Certificates

Wildcard certificates are a type of SSL/TLS certificate that covers a domain and all its subdomains. For example, a *.example.com wildcard certificate would secure www.example.com, blog.example.com, and any other subdomains under example.com. This simplifies certificate management for organizations with many subdomains.

### Code-Signing Certificates

Code-signing certificates are used to digitally sign software applications and files. When users or systems encounter a digitally signed application, they can verify that the software has not been tampered with and originates from a trusted source. This helps prevent the distribution of malicious software.

### Self-Signed Certificates

Self-signed certificates are certificates that are signed by their own private key rather than a trusted CA. While self-signed certificates can provide encryption, they lack the third-party validation that comes with certificates issued by established CAs. As a result, they are typically used for internal testing or development environments.

### Machine/Computer Certificates

Machine or computer certificates are used to authenticate and secure communications between devices and servers. These certificates are often installed on servers, routers, and other network devices, enabling secure connections in various environments.

### E-mail Certificates

E-mail certificates, also known as S/MIME certificates, are used to secure email communications. They enable users to encrypt email content and digitally sign messages, ensuring the privacy and authenticity of email correspondence.

### User Certificates

User certificates are issued to individuals and are used for various purposes, including authentication, digital signatures, and secure communications. They play a fundamental role in establishing the identity of users and enabling secure interactions.

### Root Certificates

Root certificates are the foundational certificates in a PKI hierarchy. They are self-signed certificates that serve as trust anchors, forming the basis of trust for the entire PKI. Root certificates are included in web browsers and operating systems to establish trust for certificates issued by their subordinate CAs.

### Domain Validation Certificates

Domain validation certificates are the simplest type of SSL/TLS certificates. They verify the ownership of a domain and typically require only minimal validation. Domain validation certificates are commonly used for encrypting data transmitted between users and websites.

### Extended Validation Certificates

Extended Validation certificates provide a higher level of identity verification compared to other certificate types. Websites with Extended Validation certificates display the organization's name in the browser's address bar, indicating a high level of trust and security. Extended Validation certificates are often used by businesses to instill confidence in users.

## Certificate Formats


### Distinguished Encoding Rules (DER)

DER is a binary encoding format used for storing and transmitting certificates and other X.509-related data. It provides efficient storage and transmission but is not easily human-readable.

### Privacy-Enhanced Mail (PEM)

PEM is a widely used format that encodes certificates, private keys, and other cryptographic data using Base64 encoding. PEM files are often used for storing and sharing certificates, as they can be easily read and transferred.

### Personal Information Exchange (PFX)
PFX is a format used to store private keys, certificates, and related data in a single, password-protected file. It is commonly used in Windows environments for managing certificates.

### CER

CER is a standard format used to store certificates. It can contain either DER-encoded or Base64-encoded data and is often used for importing certificates into applications and systems.

### P12

P12, also known as PKCS#12, is a format used to store private keys, certificates, and related data in a single, password-protected file. P12 files are commonly used in various platforms and applications.

### P7B
P7B is a format used to store certificates and chain certificates. Unlike PFX files, P7B files do not include private keys. They are often used for importing certificates into Windows-based systems.

## Concepts

### Online vs. Offline CA

An online CA is connected to the network and is accessible for certificate issuance and management tasks. An offline CA is disconnected from the network and operates in a more secure environment. Offline CAs are often used for root CAs to minimize the risk of compromise.

### Stapling

Certificate stapling, also known as OCSP stapling, is a technique that improves the efficiency of OCSP checks by allowing a web server to include a digitally signed OCSP response along with its SSL/TLS certificate. This helps clients verify the certificate's revocation status without contacting the CA separately.

### Pinning

Certificate pinning is a security mechanism used to prevent man-in-the-middle attacks by associating a specific public key or certificate with a domain. By pinning a certificate, clients only trust connections that present the specified key or certificate, reducing the risk of fraudulent certificates being accepted.

### Trust Model

The trust model defines how trust is established and maintained within a PKI. It includes the trust anchor, which is the root certificate that is pre-installed in systems and browsers, and the chain of trust that extends from the root to end-entity certificates.

### Key Escrow

Key escrow is the practice of storing encryption keys with a trusted third party. It is often used to ensure access to encrypted data in case the original key is lost or unavailable. Key escrow is a controversial topic due to concerns about privacy and security.

### Certificate Chaining

Certificate chaining involves linking multiple certificates together to form a chain of trust. Each certificate is signed by the next certificate in the chain, with the root certificate at the top. Certificate chaining ensures that certificates are trusted through the entire hierarchy.


## Chapter Review



## Summary of Public Key Infrastructure (PKI) Concepts

### Key Management

1. **Key Management**
   - Involves generating, storing, distributing, and maintaining cryptographic keys.
   - Ensures confidentiality, integrity, and availability of encrypted data and digital signatures.
   - Includes practices like key generation using strong algorithms, secure key storage, and regular key rotation.

### Certificate Authorities (CA) and Components

2. **Certificate Authority (CA)**
   - Trusted entity responsible for issuing digital certificates.
   - Digitally signs certificates to establish trust and verify their authenticity.

3. **Intermediate CA**
   - Subordinate to a root CA in a PKI hierarchy.
   - Enhances security by allowing delegation of certificate issuance while keeping the root CA secure.

4. **Registration Authority (RA)**
   - Verifies the identity of certificate applicants.
   - Performs identity checks and forwards certificate requests to the CA for issuance.

5. **Certificate Revocation List (CRL)**
   - Periodically published list by a CA.
   - Contains information about revoked certificates to prevent their unauthorized use.

6. **Certificate Attributes**
   - Pieces of information associated with a digital certificate.
   - Includes details such as the certificate holder's name, organization, and expiration date.

7. **Online Certificate Status Protocol (OCSP)**
   - Protocol for real-time checking of a certificate's revocation status.
   - Provides an alternative to relying solely on periodically published CRLs.

8. **Certificate Signing Request (CSR)**
   - Message submitted to a CA by a certificate applicant.
   - Includes the applicant's public key and identifying information for certificate creation.

### Certificate Types

9. **Wildcard Certificates**
   - SSL/TLS certificates that cover a domain and its subdomains.
   - Simplifies certificate management for organizations with multiple subdomains.

10. **Code-Signing Certificates**
    - Used to digitally sign software applications and files.
    - Verifies the integrity and authenticity of signed applications.

11. **Self-Signed Certificates**
    - Certificates signed by their own private keys.
    - Typically used for internal testing or development environments.

12. **Machine/Computer Certificates**
    - Authenticate and secure communications between devices and servers.
    - Installed on servers, routers, and network devices.

13. **E-mail Certificates (S/MIME)**
    - Used to secure email communications.
    - Enable encryption and digital signing of email content.

14. **User Certificates**
    - Issued to individuals for authentication, digital signatures, and secure communications.
    - Fundamental for establishing user identity.

15. **Root Certificates**
    - Foundational certificates in a PKI hierarchy.
    - Self-signed certificates serving as trust anchors for the entire PKI.

16. **Domain Validation Certificates**
    - SSL/TLS certificates verifying domain ownership.
    - Require minimal validation for encryption in data transmission.

17. **Extended Validation Certificates**
    - Provide a higher level of identity verification.
    - Display the organization's name in the browser's address bar for increased trust.

### Certificate Formats

18. **Distinguished Encoding Rules (DER)**
    - Binary encoding format for certificates and X.509-related data.
    - Efficient for storage and transmission.

19. **Privacy-Enhanced Mail (PEM)**
    - Encodes certificates, private keys, and cryptographic data using Base64.
    - Widely used for storing and sharing certificates.

20. **Personal Information Exchange (PFX)**
    - Format for storing private keys, certificates, and related data in a password-protected file.
    - Commonly used in Windows environments.

21. **CER**
    - Standard format for storing certificates.
    - Contains either DER-encoded or Base64-encoded data.

22. **P12 (PKCS#12)**
    - Format for storing private keys, certificates, and related data in a password-protected file.
    - Commonly used across various platforms.

23. **P7B**
    - Format for storing certificates and chain certificates.
    - Does not include private keys and is often used in Windows-based systems.

### Concepts

24. **Online vs. Offline CA**
    - Online CA is accessible for certificate tasks, while offline CA is disconnected for enhanced security.
    - Offline CAs are often used for root CAs to minimize the risk of compromise.

25. **Stapling**
    - Certificate stapling improves OCSP checks by including a signed OCSP response with SSL/TLS certificates.
    - Enhances efficiency in verifying certificate revocation status.

26. **Pinning**
    - Certificate pinning associates a specific public key or certificate with a domain to prevent man-in-the-middle attacks.
    - Reduces the risk of accepting fraudulent certificates.

27. **Trust Model**
    - Defines how trust is established within a PKI.
    - Includes a trust anchor (root certificate) and a chain of trust from root to end-entity certificates.

28. **Key Escrow**
    - Involves storing encryption keys with a trusted third party.
    - Ensures access to encrypted data in case of key loss, but raises privacy and security concerns.

29. **Certificate Chaining**
    - Links multiple certificates to form a chain of trust.
    - Each certificate is signed by the next in the chain, establishing trust from the root to end-entity certificates.